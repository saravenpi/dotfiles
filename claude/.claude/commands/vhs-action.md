---
allowed-tools: Glob, Read, Edit, MultiEdit, Write, Bash, Grep
description: Install and configure charmbracelet/vhs-action for automated VHS terminal recordings in GitHub Actions
bash-timeout: 300000
---

## VHS Action Setup Command

Installs and configures the [vhs-action](https://github.com/charmbracelet/vhs-action) for automated terminal recording generation in GitHub Actions workflows. This provides a cleaner, CI-integrated approach to creating VHS demos compared to local VHS installations.

### Process:

1. **Project Analysis**:
   - Check for existing GitHub Actions workflows
   - Detect project type and structure
   - Identify existing VHS tape files or demo scripts
   - Analyze package.json or other config files for dependencies

2. **Workflow Configuration**:
   - Create or update `.github/workflows/vhs.yml`
   - Configure appropriate triggers (push, PR, manual)
   - Set up job dependencies and checkout actions
   - Configure artifact upload for generated GIFs

3. **VHS Action Integration**:
   - Add vhs-action step to workflow
   - Configure tape file paths and output directories
   - Set up proper permissions for Actions
   - Configure caching for dependencies

4. **Tape File Setup**:
   - Create demo tape files if none exist
   - Organize tape files in appropriate directory structure
   - Configure output paths for generated GIFs
   - Set up realistic demo scenarios

5. **Documentation Update**:
   - Update README with automated demo information
   - Add workflow status badges
   - Document manual workflow triggers
   - Include examples of generated outputs

### Generated Workflow Structure:

```yaml
name: Generate VHS Demos

on:
  push:
    branches: [main]
    paths: ['**/*.tape', 'src/**', 'README.md']
  pull_request:
    paths: ['**/*.tape', 'src/**']
  workflow_dispatch:

jobs:
  generate-demos:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Generate VHS demos
        uses: charmbracelet/vhs-action@v2
        with:
          path: 'demos/'
          
      - name: Upload artifacts
        uses: actions/upload-artifact@v4
        with:
          name: vhs-demos
          path: 'demos/*.gif'
          
      - name: Commit generated demos
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'Update VHS demos'
          file_pattern: 'demos/*.gif'
```

### Tape File Organization:

```
project-root/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ vhs.yml
â”œâ”€â”€ demos/                # VHS tape files and outputs
â”‚   â”œâ”€â”€ installation.tape
â”‚   â”œâ”€â”€ usage.tape
â”‚   â”œâ”€â”€ features.tape
â”‚   â”œâ”€â”€ installation.gif  # Generated by Action
â”‚   â”œâ”€â”€ usage.gif        # Generated by Action
â”‚   â””â”€â”€ features.gif     # Generated by Action
â”œâ”€â”€ scripts/             # Alternative tape location
â”‚   â””â”€â”€ demo.tape
â””â”€â”€ README.md           # Updated with demo links
```

### Action Configuration Options:

**Basic Setup:**
- `path`: Directory containing .tape files (default: '.')
- `install-fonts`: Install additional fonts (default: false)
- `publish-to`: Publish GIFs to GitHub Pages or releases

**Advanced Options:**
- `setup-node`: Configure Node.js for project dependencies
- `install-dependencies`: Run package manager install
- `pre-run-command`: Execute setup commands before VHS
- `post-run-command`: Cleanup or post-processing

### Workflow Triggers:

1. **Push Events**: Automatically generate demos on main branch updates
2. **Pull Requests**: Generate demos for PR previews
3. **Manual Dispatch**: On-demand demo generation via GitHub UI
4. **Scheduled**: Periodic demo updates (optional)
5. **Release**: Generate demos for new releases

### Integration with Existing Projects:

**For CLI Tools:**
- Detect bin entries in package.json
- Create installation and usage demos
- Test CLI commands in isolated environment

**For Web Applications:**
- Set up development server demos
- Configure build process recordings
- Show deployment workflows

**For Libraries:**
- Create API usage examples
- Demonstrate integration steps
- Show testing and development setup

### Security and Permissions:

```yaml
permissions:
  contents: write      # To commit generated GIFs
  actions: read        # To access workflow artifacts
  pull-requests: write # To comment on PRs with demos
```

### Artifact Management:

- **Retention**: Configure artifact retention periods
- **Size Limits**: Optimize GIF sizes for CI storage
- **Download**: Enable manual artifact downloads
- **Publishing**: Automatic publishing to GitHub Pages or releases

### Advanced Features:

1. **Conditional Generation**:
   ```yaml
   - name: Check for tape changes
     uses: dorny/paths-filter@v2
     id: changes
     with:
       filters: |
         tapes:
           - '**/*.tape'
   
   - name: Generate VHS demos
     if: steps.changes.outputs.tapes == 'true'
     uses: charmbracelet/vhs-action@v2
   ```

2. **Multi-Platform Demos**:
   ```yaml
   strategy:
     matrix:
       os: [ubuntu-latest, macos-latest]
   runs-on: ${{ matrix.os }}
   ```

3. **PR Comments with Demos**:
   ```yaml
   - name: Comment PR
     uses: actions/github-script@v7
     with:
       script: |
         github.rest.issues.createComment({
           issue_number: context.issue.number,
           owner: context.repo.owner,
           repo: context.repo.repo,
           body: '## ðŸŽ¬ Updated Demos\n\n![Demo](https://github.com/${{ github.repository }}/raw/${{ github.sha }}/demos/demo.gif)'
         })
   ```

### Options:
- `--workflow-name NAME`: Custom workflow file name (default: vhs.yml)
- `--tape-dir DIR`: Directory for tape files (default: demos/)
- `--trigger TYPE`: Workflow triggers (push|pr|dispatch|schedule)
- `--upload-artifacts`: Enable artifact upload (default: true)
- `--auto-commit`: Automatically commit generated GIFs (default: false)
- `--setup-fonts`: Install additional fonts for recordings
- `--node-version VERSION`: Node.js version for setup (default: 18)
- `--package-manager`: Package manager (npm|yarn|pnpm|bun) - auto-detected

### Prerequisites:
- GitHub repository with Actions enabled
- Project with clear demo scenarios
- Existing tape files or willingness to create them
- Repository write permissions for automated commits

### Benefits over Local VHS:
- **Automated**: Runs on every relevant change
- **Consistent**: Same environment for all recordings  
- **Scalable**: No local VHS installation required
- **Collaborative**: Team members see updated demos automatically
- **Integrated**: Fits into existing CI/CD workflows
- **Cached**: Faster subsequent runs with dependency caching

### Generated Documentation:

The command updates README.md with:
```markdown
## Demos

Our demos are automatically generated using [VHS Action](https://github.com/charmbracelet/vhs-action).

### Installation
![Installation Demo](./demos/installation.gif)

### Usage  
![Usage Demo](./demos/usage.gif)

### Features
![Features Demo](./demos/features.gif)

---

**Note**: Demos are updated automatically on each release. See [workflow](.github/workflows/vhs.yml) for details.
```